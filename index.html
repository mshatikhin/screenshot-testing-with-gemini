<!DOCTYPE html>
<html lang="ru-RU">
<head>
    <title>Shower Presentation Engine</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="shower/themes/ribbon/styles/screen-4x3.css">
</head>
<body class="shower list black">

<style>
    body, .shower, .slide h2 {
        color: #fff;
    }

    body, .shower .black, .shower.full {
        background-color: #222;
    }
</style>

<header class="caption">
    <h1>Скриншотное тестирование с использованием gemini</h1>
    <p>Автор: Михаил Шатихин (СКБ Контур 2017)</p>
</header>

<section class="slide black" id="cover">
    <img class="cover" src="pictures/dark_eyes.png" alt="Cover">
    <h2><span style="color: #ff0000">G</span>emini</h2>
    <style>
        #cover h2 {
            position: absolute;
            top: 50%;
            color: #fff;
            text-align: center;
            font-size: 70px;
            margin-left: -15px;
            width: 100%;
            left: 0;
        }
    </style>
</section>

<section class="slide black">
    <h2 style="color: white">Обо мне</h2>
    <ul style="color: white">
        <li>Фронтендер в Контур.Гособлако</li>
        <li>Не люблю рутину</li>
        <li>Пишу тесты</li>
    </ul>
    <img src="pictures/me.jpg" class="cover"/>
</section>

<section class="slide black">
    <h2>
        <img src="./pictures/white_logo.png" style="max-width: 70%"></h2>
    <ul>
        <li>SPA приложение</li>
        <li>Много редакторов форм</li>
        <li>Кастомизация под заказчика</li>
        <li>Хостится у заказчика</li>
    </ul>
</section>

<section class="slide black">
    <img class="cover place width top" src="pictures/Создание%20сотрудника%202.png">
</section>

<section class="slide black">
    <img class="cover place width top" src="pictures/ИД%202.png">
</section>

<section class="slide black">
    <h2>Проблемы</h2>
    <ul>
        <li>Изменяя один редактор можно поламать остальные</li>
        <li>Соответствие прототипам после рефакторинга</li>
        <li>Много рутины</li>
        <li>После обновления «<a href="https://github.com/skbkontur/retail-ui">retail-ui</a>» быть спокойнее</li>
    </ul>
</section>

<section class="slide black">
    <h2 class="shout">Стильно. <br/> Модно. <br/> Молодежно.</h2>
</section>

<section class="slide black">
    <h2>Используем песочницу Storybook</h2>
    <ul>
        <li>Позволяет разрабатывать компоненты в «вакууме»</li>
        <li>Упрощает тестирование</li>
        <li>Отладка компонентов становится проще</li>
        <li>Storybook <a href="https://storybook.js.org/testing/css-style-testing/#supported-cssstyle-testing-frameworks" target="_blank">❤</a> Gemini</li>
    </ul>
</section>

<section class="slide black">
    <h2>Пишем тесты</h2>
    <ul>
        <li>e2e <code>(nigthwatch)</code></li>
        <li>css/style <code>(gemini)</code></li>
        <li>integration <code>(jest, enzyme)</code></li>
        <li>unit <code>(jest)</code></li>
        <li>structure <code>(jest snapshot)</code></li>
        <li>type checking <code>(typescript)</code></li>
    </ul>
</section>

<section class="slide black">
    <h2>Тестируем верстку</h2>
    <ul>
        <li>Делаем скриншоты компонентов в разных состояних</li>
        <li class="next">Сравниваем между собой автоматически</li>
        <li class="next">Храним эталоны в репозитории</li>
        <li class="next">Тестируем в разных браузерах</li>
    </ul>
</section>

<!--<section class="slide black">-->
<!--<h2 class="shout">Eyes</h2>-->
<!--</section>-->

<!--<section class="slide black">-->
<!--<img src="pictures/eyes1.png" class="cover"/>-->
<!--</section>-->

<!--<section class="slide black">-->
<!--<img src="pictures/eyes2.png" class="cover"/>-->
<!--</section>-->

<!--<section class="slide black">-->
<!--<img src="pictures/diff_eyes.png" class="cover"/>-->
<!--</section>-->

<!--<section class="slide black">-->
<!--<h2>Тестирование вручную</h2>-->
<!--<ul>-->
<!--<li>Много рутинной работы</li>-->
<!--<li>Человеческий фактор</li>-->
<!--<li>Боль</li>-->
<!--</ul>-->
<!--<div class="place bottom" style="bottom: 100px;">-->
<!--<img src="pictures/eyes.gif" width="500" class="next"/>-->
<!--</div>-->
<!--</section>-->


<section class="slide black">
    <h2 class="shout">Gemini</h2>
</section>

<section class="slide black">
    <h2>Gemini</h2>
    <div class="next">
        <div style="color: green">Плюсы</div>
        <ul>
            <li>Умеет делать скриншоты любой части страницы</li>
            <li>Есть API для взаимодействовия с UI</li>
            <li>Запуск тестов в разных браузерах</li>
        </ul>
    </div>
    <div class="next">
        <div style="color: red">Минусы</div>
        <ul>
            <li>Поддержка инфраструктуры (selenium)</li>
            <li>Нужно писать тесты</li>
        </ul>
    </div>
</section>

<section class="slide black">
    <h2>Бонусы</h2>
    <ul>
        <li>Эталоны в репозитории</li>
        <li>Возможность игнорировать лишнее</li>
        <li>Подробный HTML отчёт</li>
        <li>Есть GUI</li>
        <li>Полезные плагины (teamcity, react, webpack)</li>
    </ul>
</section>

<section class="slide black">
    <h2>Пример теста</h2>
    <pre>
        <code>gemini.suite('RequisiteHistoryEditor', suite => {</code>
        <code>  suite.setUrl(url)</code>
        <code>    .setCaptureElements(selectors)</code>
        <code>    .capture('clicked', function (actions, find) {</code>
        <code>      actions.click(find(rowSelector));</code>
        <code>    });</code>
        <code>});</code>
    </pre>
</section>

<section class="slide black">
    <style>
        .grey {
            color: #505050;
        }

        .blue {
            color: #376da3;
        }
    </style>
    <h2>Пример теста</h2>
    <pre>
        <code>gemini.suite(<mark>'RequisiteHistoryEditor'</mark>, suite => {</code>
        <code class="grey">  suite.setUrl(url)</code>
        <code class="grey">    .setCaptureElements(selectors)</code>
        <code class="grey">    .capture('clicked', function (actions, find) {</code>
        <code class="grey">      actions.click(find(rowSelector))</code>
        <code class="grey">    });</code>
        <code>});</code>
    </pre>
</section>

<section class="slide black">
    <h2>Пример теста</h2>
    <pre>
        <code class="grey">gemini.suite('RequisiteHistoryEditor', suite => {</code>
        <code>  suite.setUrl(<mark>url</mark>)</code>
        <code class="grey">    .setCaptureElements(selectors)</code>
        <code class="grey">    .capture('clicked', function (actions, find) {</code>
        <code class="grey">      actions.click(find(rowSelector);</code>
        <code class="grey">    });</code>
        <code class="grey">});</code>
    </pre>
</section>

<section class="slide black">
    <h2>Пример теста</h2>
    <pre>
        <code class="grey">gemini.suite('RequisiteHistoryEditor', suite => {</code>
        <code class="grey">  suite.setUrl(url)</code>
        <code>    .setCaptureElements(<mark>selectors</mark>)</code>
        <code class="grey">    .capture('clicked', function (actions, find) {</code>
        <code class="grey">      actions.click(find(rowSelector));</code>
        <code class="grey">    });</code>
        <code class="grey">});</code>
    </pre>
</section>

<section class="slide black">
    <h2>Пример теста</h2>
    <pre>
        <code class="grey">gemini.suite('RequisiteHistoryEditor', suite => {</code>
        <code class="grey">  suite.setUrl(url)</code>
        <code class="grey">    .setCaptureElements(selectors)</code>
        <code>    .capture(<mark>'clicked'</mark>, function (actions, find) {</code>
        <code>      actions.click(find(rowSelector));</code>
        <code>    });</code>
        <code class="grey">});</code>
    </pre>
</section>


<section class="slide black">
    <h2>Пример теста множеста страниц</h2>
    <pre>
        <code>const urls = <mark>[ "/", "/products", "/support" ];</mark></code>
        <code class="grey">urls.forEach((url, i) =></code>
        <code class="grey">  gemini.suite(`suite-${i}`, suite =></code>
        <code class="grey">    suite.setUrl(url)</code>
        <code class="grey">      .setCaptureElements("#root")</code>
        <code class="grey">      .capture('plain')</code>
        <code class="grey">    )</code>
        <code class="grey">)</code>
    </pre>
</section>

<section class="slide black">
    <h2>Пример теста множеста страниц</h2>
    <pre>
        <code class="grey">const urls = [ "/", "/products", "/support" ];</code>
        <code>urls.forEach((url, i) =></code>
        <code class="grey">  gemini.suite(`suite-${i}`, suite =></code>
        <code class="grey">    suite.setUrl(url)</code>
        <code class="grey">      .setCaptureElements("#root")</code>
        <code class="grey">      .capture('plain')</code>
        <code class="grey">    )</code>
        <code>)</code>
    </pre>
</section>

<section class="slide black">
    <h2>Пример теста множеста страниц</h2>
    <pre>
        <code class="grey">const urls = [ "/", "/products", "/support" ];</code>
        <code class="grey">urls.forEach((url, i) =></code>
        <code>  gemini.suite(`suite-${i}`, suite =></code>
        <code>    suite.setUrl(url)</code>
        <code>      .setCaptureElements("#root")</code>
        <code>      .capture('plain')</code>
        <code>    )</code>
        <code class="grey">)</code>
    </pre>
</section>


<section class="slide black">
    <h2 class="shout">Из жизни</h2>
</section>

<section class="slide black">
    <img src="pictures/tree_ex_1.jpg" class="cover"/>
</section>

<section class="slide black">
    <h2 class="shout">Что-то поменялось</h2>
</section>

<section class="slide black">
    <img src="pictures/tree_ex_2.jpg" class="cover"/>
</section>

<section class="slide black">
    <img src="pictures/tree_ex_3.jpg" class="cover"/>
</section>

<section class="slide black">
    <img src="pictures/gos_example_1.jpg" class="cover width"/>
</section>

<section class="slide black">
    <img src="pictures/gos_example_3.jpg" class="cover width"/>
</section>

<section class="slide black">
    <h2>Профит использования css/style тестирования</h2>
    <ul>
        <li>Нет боли при рефакторинге</li>
        <li>Оперативно видим что сломалось</li>
        <li>Больше времени на разработку*</li>
    </ul>
</section>

<section class="slide black">
    <h2>Call to action</h2>
    <ul>
        <li class="next">Используйте песочницу компонентов</li>
        <li class="next">Попробуйте написать скриншотный тест</li>
    </ul>
</section>

<section class="slide black">
    <h2>Ссылки</h2>
    <ul>
        <li><a target="_blank" href="https://github.com/gemini-testing/gemini">github.com/gemini-testing/gemini</a></li>
        <li><a target="_blank"
               href="https://github.com/mshatikhin/gemini-example">github.com/mshatikhin/gemini-example</a></li>
        <li><a target="_blank" href="https://github.com/mshatikhin/gemini-react-starter">github.com/mshatikhin/gemini-react-starter</a>
        </li>
        <li><a target="_blank" href="https://getstorybook.io/docs/react-storybook/testing/css-style-testing">getstorybook.io/docs/react-storybook</a>
        </li>
        <li><a target="_blank" href="https://events.yandex.ru/lib/talks/4262/">Gemini: различные способы
            использования</a></li>
        <li><a target="_blank" href="https://gist.github.com/cvrebert/adf91e429906a4d746cd">Другие инструменты CSS
            Regression
            Testing</a></li>
    </ul>
</section>

<section class="slide black">
    <h2>Вопросы?</h2>
    <div>
        <img src="pictures/giphy.gif" class="cover" width="600"/>
    </div>
</section>

<section class="slide black">
    <h2>Как настроить git lfs</h2>
    <ul>
        <li>>$ git lfs install</li>
        <li>>$ git lfs track "gemini/screens/**/*"</li>
    </ul>
</section>

<section class="slide black">
    <img src="pictures/git_screenshot.png" class="cover"/>
</section>

<!--
    To hide progress bar from entire presentation
    just remove “progress” element.
    -->
<!--<div class="progress"></div>-->
<script src="shower/shower.min.js"></script>
<!-- Copyright © 2015 Yours Truly, Famous Inc. -->
<!-- Photos by John Carey, fiftyfootshadows.net -->
</body>
</html>
